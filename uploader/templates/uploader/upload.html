{% extends 'uploader/base.html' %}

{% block content %}
<div class="content">
    <div class="itembox">
    <form method="post" enctype="multipart/form-data" id="fileUploadForm">
        {% csrf_token %}
        <div class="form-group">
            <label for="folder_select">アップロード先</label>
            <select name="folder_select" id="folder_select" class="form-control">
            {% for folder_name in dir_list %}
                <option value="{{ folder_name }}"
                    {% if folder_name == request.session.last_selected_folder %} selected {% endif %}>
                    {{ folder_name }}
                </option>
            {% endfor %}
            </select>
        </div>
        <div class="bt-select"><input type="file" multiple name="file" value=""></div>
        <div class="information"><p>{{ information }}</p></div>
        <div class="syoribtn">
        <div class="bt-upload"><button type="submit" name="action" value="upload">アップロード</button></div>
        <div class="bt-clear"><button type="submit" name="action" value="clear">クリア</button></div>
        </div>
    </form>
    <div class="result">
    <table>
        <tr>
            <th>ファイル名</th>
            <th>アップロード結果</th>
            <th>アップロード時間</th>
        </tr>
        {% for file_info in request.session.file_history %}
        <tr>
            <td>
                {{ file_info.file_name }}
            </td>
            <td>
                {% if file_info.success_message %}
                <p class="alert alert-success" id="success-message">{{ file_info.success_message }}</p>
                {% endif %}
        
                {% if file_info.error_message %}
                <p class="alert alert-danger" id="error-message">{{ file_info.error_message }}</p>
                {% endif %}
            </td>
            <td>
                {{ file_info.file_time }}
            </td>
        </tr>
        {% endfor %}    
    </table>
    </div>
    </div>
</div>
{% endblock %}
